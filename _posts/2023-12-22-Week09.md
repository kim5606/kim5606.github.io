---
title: 정글 9주차
author: cotes
date: 2023-12-22 14:30:00 +0800
categories: [크래프톤 정글]
tags: [PintOS]
pin: true
math: true
mermaid: true
---

# 2023.12.22 TIL

#### MMAP 구현 시작

- 파일과 메모리 매핑은 syscall 의 mmap()을 통해 이뤄진다.
  mmap()함수는 do_mmap()함수를 실행시키기 위한 조건을 나열해야하는데

매핑이 이뤄질 수 없는 경우는 다음과 같다.

- addr가 없는 경우
- addr가 page-aligned 되지 않은 경우
- offset이 page-aligned되지 않은 경우
- addr가 user 영역이 아닌 경우
- addr + length가 user 영역이 아닌 경우
- (addr부터 파일의 내용을 매핑해나가면 마지막 주소는 addr+length가 되는데, 이 주소도 user 영역 안에 존재해야 한다.)
- addr에 할당된 페이지가 이미 존재하는 경우
- fd에 해당하는 file이 없는 경우
- file의 길이가 0이거나 0보다 작은 경우

매핑이 이뤄질 수 없는 경우에 대해서 if 문으로 제외한 뒤, mmap 함수 구현을 시작해야한다.
또한, syscall 자체를 만드는 것이므로 syscall.c에 구현한다.
