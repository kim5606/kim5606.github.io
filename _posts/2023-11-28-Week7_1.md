---
title: 정글 7주차, Pintos 공부1
author: cotes
date: 2023-11-28 11:00:00 +0800
categories: [크래프톤 정글]
tags: [PintOS]
pin: true
math: true
mermaid: true
---

# 2023.11.23 TIL

## PintOS 1주차 목표

- 핀토스는 최소한의 쓰레드 시스템이 구현되어져 있다.

이번 과제에서는 이 쓰레드 체계를 확장시키고(기능을 추가하는 등) 동기화 문제를 해결하는 것이 주된 업무이다.

최소한의 기능을 갖춘 thread system에서 device directory 와 thread directory 의 파일들을 적절히 수정해 Alarm Clock, Priority Scheduling, Advanced Scheduler 의 요구사항들을 충족하자!

우선! OS 강의 부터 시작하자

---

### 조지아 대학 OS 강의

#### 운영 체제란 무엇을 진행하는가?

강의에서는 장난감 가게 관리자를 메타포로 사용하여 비유를 든다.

| 장난감 가게 관리자                                     | 실제 운영 체제                                     | 관련 함수/시스템 호출 |
| ------------------------------------------------------ | -------------------------------------------------- | --------------------- |
| 매니저는 직원을 고용하고, 작업을 지시한다.             | 운영 체제는 하드웨어 자원을 관리한다.              | `malloc`, `calloc`    |
| 매장 내 자원, 부품, 도구를 배분한다.                   | 프로세스와 애플리케이션에 자원을 할당한다.         | `malloc`, `mmap`      |
| 어떤 직원이 어떤 주문을 어떤 도구로 처리할지 결정한다. | 프로세스 스케줄링을 통해 자원 사용을 결정한다.     | `fork`, `exec`        |
| 공정성, 안정성, 청소 정책을 시행한다.                  | 시스템 자원에 대한 공정한 접근을 보장한다.         | `nice`, `setpriority` |
| 공유 리소스와 도구를 효율적으로 사용하게 한다.         | 리소스 사용에 제한을 둔다 (예: 열린 파일 수 제한). | `ulimit`, `setrlimit` |
| 작업자가 작업을 마친 후에는 정리하도록 한다.           | 프로세스 종료 시 자원을 회수한다.                  | `free`, `close`       |
| 복잡한 작업을 간소화하고 최적화한다.                   | 시스템 호출을 통해 복잡한 작업을 간소화한다.       | `write`, `read`       |
| 전반적인 작업 효율을 개선한다.                         | 하드웨어와의 상호작용을 추상화한다.                | `ioctl`, `open`       |

#### 컴퓨팅 시스템에서 운영 체제의 역할이란 무엇인가?

![Alt text](https://raw.githubusercontent.com/kim5606/kim5606.github.io/main/_posts/1_OS구조사진.png)

1. 운영 체제는 기본 프로세스의 복잡성을 숨긴다.

- 하드 디스크, SSD, USB 등의 다양한 유형 장치, 더 높은 수준의 추상화를 관리하고 일부 기능을 제공한다.

2. 기본 하드웨어를 대신해서 관리한다.

- 메모리를 할당하면서, 애플리케이션을 실행할 수 있는 CPU에 예약하고, 제어한다.

- 모든 유형의 리소스 할당과 애플리케이션을 대신해 리소스 관리 작업을 수행한다.

3. 운영체제는 격리 및 보호 기능을 제공한다.

- 동일한 하드웨어에서 여러 애플리케이션이 실행되는 경우, 그들이 제대로 수행할 수 있게끔 격리한다.

- 의도하지 않는 한, 응용 프로그램은 서로의 메모리에 엑세스하지 않는다.

#### 운영 체제에 대한 중간 요약!

- 애플리케이션과 하드웨어 사이에 상주하는 시스템 소프트웨어
  - 기본 하드웨어에 액세스하고 상태를 조작한다. (애플리케이션은 불가능)
  - 하드웨어 복잡성을 숨기고, 애플리케이션을 대신하여 하드웨어 관리한다.
  - 애플리케이션이 서로 보호되어 있는지를 확인한다.

#### QUIZ / 과연 어떤 것이 OS에 포함되는 것일까요?

| 항목          | OS에 포함되는가? | 이유                                                                                                             |
| ------------- | ---------------- | ---------------------------------------------------------------------------------------------------------------- |
| file editor   | ❌               | 사용자가 직접 상호 작용하므로 운영 체제 하드웨어 관리에는 직접 관여하지 않는다.                                  |
| file system   | ✅               | 하드웨어 복잡성을 숨기고, 더 간단하고 직관적인 추상화를 제공한다. 디스크 저장소 블록과 반대되는 파일을 관리한다. |
| device driver | ✅               | 하드웨어 장치의 사용에 관한 결정을 내리고 관리하는 장치이다.                                                     |
| cache memory  | ❌               | 성능 향상을 위해 사용되지만, 직접 '관리'하지는 않는다.                                                           |
| web browser   | ❌               | 파일 에디터와 마찬가지로 사용자와 직접 상호작용하므로 OS에 포함되지 않는다.                                      |
| scheduler     | ✅               | CPU에 대한 액세스를 분산하고, 해당 플랫폼을 공유하는 모든 애플리케이션 중에서 작업을 조율한다.                   |

#### QUIZ / 해당 내용은 어떤 추상화일까요?

| 항목                                                      | 추상화 유형              | 설명                                                                                                 |
| --------------------------------------------------------- | ------------------------ | ---------------------------------------------------------------------------------------------------- |
| 여러 프로세스간 메모리를 분산합니다.                      | R (기본 하드웨어 단순화) | 운영 체제는 메모리를 관리하고 여러 프로세스가 공유하는 방법을 결정한다.                              |
| 다양한 유형의 스피커를 지원합니다.                        | B (기본 하드웨어 관리)   | 스피커를 한 세트 꽂고, 효과가 없으면 다른 것으로 교환하는 추상화. 어떤 경우에는 드라이버가 필요하다. |
| 하드 디스크나 SSD의 상호 교환 가능한 액세스를 제공합니다. | B (기본 하드웨어 관리)   | 2번과 비슷한 유형이므로, 상호 교환 액세스 기능도 있다.                                               |

#### 실제 운영 체제의 예는 뭔가요?

| 분류               | 운영 체제         | 시작 연대 | 비고                     |
| ------------------ | ----------------- | --------- | ------------------------ |
| 데스크톱 운영 체제 | Microsoft Windows | 1980년대  | 마이크로소프트에서 시작  |
| 데스크톱 운영 체제 | UNIX-Based        | 1960년대  | 벨 연구소에서 시작       |
|                    | MAC OS X          |           | 버클리 시스템 배포판     |
|                    | LINUX             |           | 다양한 버전 (예: UBUNTU) |
| 임베디드           | 안드로이드        |           | Linux 기반               |
| 임베디드           | iOS               |           | Apple의 운영 체제        |
| 임베디드           | Symbian           |           | 모바일 장치용 운영 체제  |

#### OS elements

- 추상화 Abstractions

  - 프로세스 및 스레드
    - 운영 체제가 실행하는 응용 프로그램, 경량의 실행 단위다
  - 파일, 소켓, 메모리 페이지
    - 하드웨어 리소스스에 더 밀접하게 연결된 추상화다.
    - 메모리 페이지는 물리적 메모리를 관리하기 위해 자원으로 추상화 한다.

- 매커니즘 Mechanisms

  - 생성, 실행
    - 운영 체제가 프로그램을 메모리에 로드하고 실행하는 과정 관리
  - 열기, 쓰기, 할당
    - 파일 시스템, 소켓, 메모리 관리 같은 추상화 리소스를 실제 사용

- 정책 Polices
  - 가장 최근 사용한 것만 사용 (Least Recently Used, LRU)
    - 메모리 관리에 자주 사용된다
  - 작업 스케쥴링 (Earlies Deadline First, EDF)
    - 마감 기한이 가장 빠른 작업을 우선 처리한다.

#### OS의 메모리 관리 예시

주소 -> 페이지 -> DRAM :DISK:

주소를 DRAM으로 옮기는 과정에서의 OS는 이렇게 작동한다.

- 메모리 페이지 추상화
- 할당, map to a process
  -> 해당 과정을 통해, 주소 -> 페이지 -> DRAM으로 할당된다.
- LRU 정책 시행
  -> 일정 기간 동안 가장 최근에 사용되지 않은 페이지는 DISK로 이동된다.
  (DISK에서 불러오는게 더 걸리기 때문에, 저장소로 옮긴다. SWAPPING)

#### 운영 체제 설계 지침

| 설계 지침              | 설명                                                                                                                                       | 예시/비고                                                                                          |
| ---------------------- | ------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------- |
| 매커니즘과 정책의 분리 | 매커니즘은 유연하게 설계되어야 하며, 다양한 정책을 지원할 수 있어야 한다. 이를 통해 시스템은 다양한 상황과 요구사항에 맞게 조정될 수 있다. | LRU (Least Recently Used), LFU (Least Frequently Used), Random 교체 등의 메모리 관리 정책          |
| 일반적인 경우          | 운영 체제의 설계는 가장 일반적인 사용 사례를 고려하여 이루어져야 한다. 이를 통해 가장 효과적인 성능과 자원 활용을 달성할 수 있다.          | 1. 시스템의 실행 환경과 프로세스의 수 2. 사용자의 일반적인 행동 양식 3. 워크로드의 특성과 요구사항 |

#### 유저 / 커널 보호구역

컴퓨터는 다음과 같은 역할을 구분한다. (OS는 하드웨어 직접 접근이 가능하다.)

- USER - LEVEL (권한 없는 사용자 모드)

  - 응용 프로그램 실행
  - 하드웨어 접근 시, 트랩이 발동하여 응용 프로그램이 중단된다.

- KERNEL - LEVEL (권한 있는 커널 모드)
  - 하드웨어 접근 (CPU에 특수 비트가 설정되면, 하드웨어 접근이 가능하다)
  - 시스템 콜 (open, send, malloc) 가능 후, 애플리케이션에 알림을 전달

#### 시스템 콜

```bash

사용자 프로세스 [User mode (mode bit = 1)]

[ 실행 중 사용자 프로세스 ] --> [ 시스템 콜 호출  ] [ 시스템 콜 받기 ]
                    ↘                              ↗
커널 [kernel mode (mode bit = 0)]                 ↗
     trap mode bit  = 0  ↘                      ↗   trap mode bit = 1
                         [   시스템 콜   실행   ]
```

#### 시스템 콜 진행 과정 ( \* == 현재 위치)

- 현재 위치(\*) 가 시스템 콜에 위치 할 경우, 운영 체제가 제어권을 갖고 있는다.

- 시스템 호출을 수행하려면 애플리케이션이 인수(arguments)를 작성해야한다.

- 모든 관련 데이터를 잘 정의된 위치에 저장한다.

- 특정 시스템 호출 번호를 사용하여 실제 시스템 호출을 수행해야한다.

!! 해당 호출 번호에 대한 코드를 잘 짜야 하는건가,,,

```bash
                                                      ┌───────────────────┐
┌───────────────────────────┐  ┌───── [X] ─────┐      │                   │
│ X : parameters for call   │  │   register    │      │-------------------│
│                           │  │               └────> │  user parameters  │
│     load address X ──────────┘     ┌──────────────> │   from table X    │
│                           │        │                │   ( code for      │
│                           │        │                │  system call 13)  │
│                           │        │                │-------------------│
│                           │        │                │                   │
│     system call 13 ────────────────┘                └───────────────────┘
└───────────────────────────┘
    user program                                        operating system

```

- 직접 전달 - 사용자 프로그램과 사용자 프로그램 간 인수 직접 전달 가능
- 간접 전달 - os 또는 주소를 지정하여 간접적으로 전달 가능

- Synchronous mode : 시스템 호출이 완료될 때 까지 기다리는 것

!! 운영 체제 서비스를 호출하고 결과를 얻는다는 것에 집중

### 유저/커널 보호구역 교차(전환)

즉, 사용자 / 커널 전환은 필수 단계이다.

- 오직 커널 모드의 OS만 가능하다.

  - 애플리케이션의 하드웨어에 대한 액세스를 수행, 할당 요청

- 트랩모드 발동 조건

  - 비 특권 모드가 일부 명령 수행 시도
  - 권한 없는 메모리 액세스

- 전환의 문제점
  - 실제 소요 시간이 존재한다.
  - 하드웨어에 영향을 미친다. (캐시 사용량)
    - 캐시 액세스에 몇 사이클 걸린다면, 메모리 액세스는 수백 사이클이 걸릴 수 있다.

! 반복 설명 하는 부분

1. OS가 할 수 있는 권한은 굉장히 명확하다. (추상화, 정책, 매커니즘)
2. 유저/커널 역할 교차는 굉장히 코스트가 많이 드는 작업이다.

### OS가 제공하는 것들 요약

- 운영체제는 여러가지 기능을 통합 해야하는 관리 기능들을 많이 수행한다. (파일, 프로세스...)

- 이를 시스템 호출을 통해 모든 서비스를 사용 가능하다.

![Alt text](https://raw.githubusercontent.com/kim5606/kim5606.github.io/main/_posts/2_시스템콜.png)

윈도우 VS 리눅스 시스템 콜

#### SYSYEM CALLS QUIZ

- 프로세스에 신호를 보내기 위한 신호는 ?
  - [kill]
- 프로세스 그룹 ID 설정은?
  - [setgid]
- 파일 시스템 마운트 방법?
  - [mount]
- 읽고 쓰는 시스템 파라미터는?
  - [stsctl]

### 모놀리식 / 모듈러 OS / 마이크로 커널 장 단점

| OS 유형       | 장점                                           | 단점                                                   |
| ------------- | ---------------------------------------------- | ------------------------------------------------------ |
| 모놀리식 OS   | 간단한 구조, 빠른 성능                         | 오류가 전체 시스템에 영향, 유지보수 및 업데이트 어려움 |
| 모듈러 OS     | 유연한 구조, 업그레이드 용이, 자원 효율적 사용 | 모듈 간 의존성 관리, 성능 오버헤드 가능성              |
| 마이크로 커널 | 높은 안정성 및 보안, 유지보수 용이             | 성능 오버헤드, 복잡한 설계 및 구현                     |

---

## 스파르타 코딩 클럽 채용 설명회

누구나 큰 일 낼 수 있어,,,

Q. 다양한 사업을 왜 진행하는가 ?

- '근간' 은 교육업

일 하는 방식

1. 전사 컨퍼런스 콜 매주 1회 (너무 짧은거 아닌가?)
2. 랜덤 런치 -> 다양한 직군 내에서의 커뮤니케이션 도모
3. 스터디 많이 하고, 실패와 착오에 대해서 열려있음

- 개발자 20명 중, 1~2명 빼고 부트캠프 출신

4. 스스로 만들 수 있는 프로덕트들이 많다.

Q. 내 질문 / 실제 일 작동 방식은 팀바팀인가?...
A. 개발자는 프로덕트 특성에 따라 갈린다.
매 주마다 컨퍼런스 콜로 싱크를 맞추는 과정이 있음

++ 너무 많은 프로덕트라 중심되는 일 작동 방식이 필요해 보였고, 설명이 필요해서 질문했음

Q. 온보딩 과정이 어떻게 되는가?
A. 없었던 때도 있었음 (홀리 쓋!) 직접 가르쳐준다기보다는 과제 형식으로 온보딩을 진행

Q. AI쪽 파트 있나?
A. 확장 가능성이 있다...라고 답변

Q. 기술적 요구가 무엇인지?
A. 인적성 관련 얘기가 주로 얘기가 나왔고, 기술적 요구사항은 딱히 없음

Q. 직급?
A. 대표 -> 파트장 -> 직원

### 생각...

- 개발 문화는 잘 퍼져있는 느낌 ,,
  - 주니어가 배울 수 있는 깊이 있는 사람은 존재하는가?
  - 일 작동 방식 중, 큰 틀에서 균일화 된 것은 없는가?
- 회사에 대한 프로덕트가 너무 많고, 다양한 일을 할 수 있는건 좋지만, 반대로 특정 일을 원하는 사람에게는 맞는 핏이 아닐 수 있겠다.

- 첫 강의부터 완벽하게 들으려고 너무 할애를 많이 한 느낌,,

---
